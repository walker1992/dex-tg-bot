"""
Main Keyboard Layouts
"""
from telegram import InlineKeyboardButton, InlineKeyboardMarkup, ReplyKeyboardMarkup, KeyboardButton


def get_main_keyboard() -> InlineKeyboardMarkup:
    """Get main menu keyboard"""
    keyboard = [
        [
            InlineKeyboardButton("üí∞ Balance", callback_data="menu_balance"),
            InlineKeyboardButton("üìä Positions", callback_data="menu_positions")
        ],
        [
            InlineKeyboardButton("üìã Orders", callback_data="menu_orders"),
            InlineKeyboardButton("üìà Market Data", callback_data="menu_market")
        ],
        [
            InlineKeyboardButton("üõí Trading", callback_data="menu_trading"),
            InlineKeyboardButton("üîî Alerts", callback_data="menu_alerts")
        ],
        [
            InlineKeyboardButton("‚öôÔ∏è Settings", callback_data="menu_settings"),
            InlineKeyboardButton("üîó Connect Exchange", callback_data="menu_connect")
        ],
        [
            InlineKeyboardButton("‚ùì Help", callback_data="menu_help")
        ]
    ]
    return InlineKeyboardMarkup(keyboard)


def get_exchange_keyboard() -> InlineKeyboardMarkup:
    """Get exchange selection keyboard"""
    keyboard = [
        [
            InlineKeyboardButton("üî∑ Hyperliquid", callback_data="exchange_hyperliquid"),
            InlineKeyboardButton("üî∂ Aster", callback_data="exchange_aster")
        ],
        [
            InlineKeyboardButton("üìä Both Exchanges", callback_data="exchange_both")
        ],
        [
            InlineKeyboardButton("üîô Back to Main", callback_data="menu_main")
        ]
    ]
    return InlineKeyboardMarkup(keyboard)


def get_trading_keyboard() -> InlineKeyboardMarkup:
    """Get trading keyboard"""
    keyboard = [
        [
            InlineKeyboardButton("üí∞ Balance", callback_data="trading_balance"),
            InlineKeyboardButton("üìä Positions", callback_data="trading_positions")
        ],
        [
            InlineKeyboardButton("üìã Orders", callback_data="trading_orders"),
            InlineKeyboardButton("üìà Price", callback_data="trading_price")
        ],
        [
            InlineKeyboardButton("üõí Quick Buy", callback_data="trading_quick_buy"),
            InlineKeyboardButton("üõçÔ∏è Quick Sell", callback_data="trading_quick_sell")
        ],
        [
            InlineKeyboardButton("üîô Back to Main", callback_data="menu_main")
        ]
    ]
    return InlineKeyboardMarkup(keyboard)


def get_market_keyboard() -> InlineKeyboardMarkup:
    """Get market data keyboard"""
    keyboard = [
        [
            InlineKeyboardButton("üìà Price", callback_data="market_price"),
            InlineKeyboardButton("üìä Depth", callback_data="market_depth")
        ],
        [
            InlineKeyboardButton("üí∞ Funding Rate", callback_data="market_funding"),
            InlineKeyboardButton("üìä 24h Stats", callback_data="market_24h")
        ],
        [
            InlineKeyboardButton("üîç Search Symbol", callback_data="market_search"),
            InlineKeyboardButton("‚≠ê Favorites", callback_data="market_favorites")
        ],
        [
            InlineKeyboardButton("üîô Back to Main", callback_data="menu_main")
        ]
    ]
    return InlineKeyboardMarkup(keyboard)


def get_alerts_keyboard() -> InlineKeyboardMarkup:
    """Get alerts keyboard"""
    keyboard = [
        [
            InlineKeyboardButton("üîî My Alerts", callback_data="alerts_list"),
            InlineKeyboardButton("‚ûï New Alert", callback_data="alerts_new")
        ],
        [
            InlineKeyboardButton("üìà Price Alert", callback_data="alerts_price"),
            InlineKeyboardButton("üí∞ Funding Alert", callback_data="alerts_funding")
        ],
        [
            InlineKeyboardButton("üìä Position Alert", callback_data="alerts_position"),
            InlineKeyboardButton("‚öôÔ∏è Alert Settings", callback_data="alerts_settings")
        ],
        [
            InlineKeyboardButton("üîô Back to Main", callback_data="menu_main")
        ]
    ]
    return InlineKeyboardMarkup(keyboard)


def get_settings_keyboard() -> InlineKeyboardMarkup:
    """Get settings keyboard"""
    keyboard = [
        [
            InlineKeyboardButton("üîó Exchange Accounts", callback_data="settings_accounts"),
            InlineKeyboardButton("üîê Security", callback_data="settings_security")
        ],
        [
            InlineKeyboardButton("üîî Notifications", callback_data="settings_notifications"),
            InlineKeyboardButton("üé® Theme", callback_data="settings_theme")
        ],
        [
            InlineKeyboardButton("üìä Trading Settings", callback_data="settings_trading"),
            InlineKeyboardButton("üõ°Ô∏è Risk Management", callback_data="settings_risk")
        ],
        [
            InlineKeyboardButton("üîô Back to Main", callback_data="menu_main")
        ]
    ]
    return InlineKeyboardMarkup(keyboard)


def get_connect_keyboard() -> InlineKeyboardMarkup:
    """Get connect exchange keyboard"""
    keyboard = [
        [
            InlineKeyboardButton("üî∑ Connect Hyperliquid", callback_data="connect_hyperliquid"),
            InlineKeyboardButton("üî∂ Connect Aster", callback_data="connect_aster")
        ],
        [
            InlineKeyboardButton("üìä View Accounts", callback_data="connect_accounts"),
            InlineKeyboardButton("üîå Disconnect", callback_data="connect_disconnect")
        ],
        [
            InlineKeyboardButton("üîô Back to Main", callback_data="menu_main")
        ]
    ]
    return InlineKeyboardMarkup(keyboard)


def get_symbol_keyboard(symbols: list) -> InlineKeyboardMarkup:
    """Get symbol selection keyboard"""
    keyboard = []
    
    # Create rows of 2 buttons each
    for i in range(0, len(symbols), 2):
        row = []
        for j in range(2):
            if i + j < len(symbols):
                symbol = symbols[i + j]
                row.append(InlineKeyboardButton(symbol, callback_data=f"symbol_{symbol}"))
        keyboard.append(row)
    
    # Add back button
    keyboard.append([InlineKeyboardButton("üîô Back", callback_data="menu_market")])
    
    return InlineKeyboardMarkup(keyboard)


def get_alert_type_keyboard() -> InlineKeyboardMarkup:
    """Get alert type selection keyboard"""
    keyboard = [
        [
            InlineKeyboardButton("üìà Price Alert", callback_data="alert_type_price"),
            InlineKeyboardButton("üí∞ Funding Alert", callback_data="alert_type_funding")
        ],
        [
            InlineKeyboardButton("üìä Position Alert", callback_data="alert_type_position"),
            InlineKeyboardButton("‚è∞ Time Alert", callback_data="alert_type_time")
        ],
        [
            InlineKeyboardButton("üîô Back to Alerts", callback_data="menu_alerts")
        ]
    ]
    return InlineKeyboardMarkup(keyboard)


def get_condition_keyboard(alert_type: str) -> InlineKeyboardMarkup:
    """Get condition selection keyboard based on alert type"""
    if alert_type == "price":
        keyboard = [
            [
                InlineKeyboardButton("üìà Above", callback_data="condition_above"),
                InlineKeyboardButton("üìâ Below", callback_data="condition_below")
            ],
            [
                InlineKeyboardButton("üéØ Equals", callback_data="condition_equals")
            ]
        ]
    elif alert_type == "funding":
        keyboard = [
            [
                InlineKeyboardButton("üìà Above", callback_data="condition_above"),
                InlineKeyboardButton("üìâ Below", callback_data="condition_below")
            ]
        ]
    elif alert_type == "position":
        keyboard = [
            [
                InlineKeyboardButton("üí∞ PnL Above", callback_data="condition_pnl_above"),
                InlineKeyboardButton("üí∞ PnL Below", callback_data="condition_pnl_below")
            ],
            [
                InlineKeyboardButton("üõ°Ô∏è Margin Above", callback_data="condition_margin_above"),
                InlineKeyboardButton("üõ°Ô∏è Margin Below", callback_data="condition_margin_below")
            ]
        ]
    else:
        keyboard = []
    
    keyboard.append([InlineKeyboardButton("üîô Back", callback_data="alerts_new")])
    
    return InlineKeyboardMarkup(keyboard)


def get_confirmation_keyboard(action: str, data: str) -> InlineKeyboardMarkup:
    """Get confirmation keyboard"""
    keyboard = [
        [
            InlineKeyboardButton("‚úÖ Confirm", callback_data=f"confirm_{action}_{data}"),
            InlineKeyboardButton("‚ùå Cancel", callback_data=f"cancel_{action}")
        ]
    ]
    return InlineKeyboardMarkup(keyboard)


def get_pagination_keyboard(current_page: int, total_pages: int, prefix: str) -> InlineKeyboardMarkup:
    """Get pagination keyboard"""
    keyboard = []
    
    # Previous and Next buttons
    row = []
    if current_page > 1:
        row.append(InlineKeyboardButton("‚¨ÖÔ∏è Previous", callback_data=f"{prefix}_page_{current_page-1}"))
    
    row.append(InlineKeyboardButton(f"Page {current_page}/{total_pages}", callback_data="noop"))
    
    if current_page < total_pages:
        row.append(InlineKeyboardButton("Next ‚û°Ô∏è", callback_data=f"{prefix}_page_{current_page+1}"))
    
    keyboard.append(row)
    
    return InlineKeyboardMarkup(keyboard)


def get_quick_actions_keyboard() -> ReplyKeyboardMarkup:
    """Get quick actions reply keyboard"""
    keyboard = [
        [
            KeyboardButton("üí∞ Balance"),
            KeyboardButton("üìä Positions")
        ],
        [
            KeyboardButton("üìà Price BTC"),
            KeyboardButton("üìà Price ETH")
        ],
        [
            KeyboardButton("üîî Alerts"),
            KeyboardButton("‚öôÔ∏è Settings")
        ]
    ]
    return ReplyKeyboardMarkup(keyboard, resize_keyboard=True, one_time_keyboard=False)


def get_trading_quick_keyboard() -> ReplyKeyboardMarkup:
    """Get trading quick actions keyboard"""
    keyboard = [
        [
            KeyboardButton("üõí Buy BTC"),
            KeyboardButton("üõçÔ∏è Sell BTC")
        ],
        [
            KeyboardButton("üõí Buy ETH"),
            KeyboardButton("üõçÔ∏è Sell ETH")
        ],
        [
            KeyboardButton("üìä My Positions"),
            KeyboardButton("üìã My Orders")
        ],
        [
            KeyboardButton("üîô Main Menu")
        ]
    ]
    return ReplyKeyboardMarkup(keyboard, resize_keyboard=True, one_time_keyboard=False)


def get_trading_exchange_keyboard() -> InlineKeyboardMarkup:
    """Get trading exchange selection keyboard"""
    keyboard = [
        [
            InlineKeyboardButton("üî∑ Hyperliquid", callback_data="trade_exchange_hyperliquid"),
            InlineKeyboardButton("üî∂ Aster", callback_data="trade_exchange_aster")
        ],
        [
            InlineKeyboardButton("üîô Back to Trading", callback_data="menu_trading")
        ]
    ]
    return InlineKeyboardMarkup(keyboard)


def get_trading_market_type_keyboard(exchange: str) -> InlineKeyboardMarkup:
    """Get trading market type selection keyboard"""
    keyboard = [
        [
            InlineKeyboardButton("üí± Spot Trading", callback_data=f"trade_market_spot_{exchange}"),
            InlineKeyboardButton("üìà Futures Trading", callback_data=f"trade_market_futures_{exchange}")
        ],
        [
            InlineKeyboardButton("üîô Back to Exchange", callback_data="trade_exchange_select")
        ]
    ]
    return InlineKeyboardMarkup(keyboard)


def get_trading_side_keyboard(exchange: str, market_type: str) -> InlineKeyboardMarkup:
    """Get trading side selection keyboard"""
    if market_type == "futures":
        keyboard = [
            [
                InlineKeyboardButton("üü¢ Long (Buy)", callback_data=f"trade_side_long_{exchange}_{market_type}"),
                InlineKeyboardButton("üî¥ Short (Sell)", callback_data=f"trade_side_short_{exchange}_{market_type}")
            ],
            [
                InlineKeyboardButton("üîô Back to Market Type", callback_data=f"trade_exchange_{exchange}")
            ]
        ]
    else:  # spot
        keyboard = [
            [
                InlineKeyboardButton("üõí Buy", callback_data=f"trade_side_buy_{exchange}_{market_type}"),
                InlineKeyboardButton("üõçÔ∏è Sell", callback_data=f"trade_side_sell_{exchange}_{market_type}")
            ],
            [
                InlineKeyboardButton("üîô Back to Market Type", callback_data=f"trade_exchange_{exchange}")
            ]
        ]
    return InlineKeyboardMarkup(keyboard)


def get_leverage_keyboard(exchange: str, symbol: str) -> InlineKeyboardMarkup:
    """Get leverage selection keyboard"""
    keyboard = [
        [
            InlineKeyboardButton("1x", callback_data=f"leverage_1_{exchange}_{symbol}"),
            InlineKeyboardButton("2x", callback_data=f"leverage_2_{exchange}_{symbol}"),
            InlineKeyboardButton("3x", callback_data=f"leverage_3_{exchange}_{symbol}")
        ],
        [
            InlineKeyboardButton("5x", callback_data=f"leverage_5_{exchange}_{symbol}"),
            InlineKeyboardButton("10x", callback_data=f"leverage_10_{exchange}_{symbol}"),
            InlineKeyboardButton("20x", callback_data=f"leverage_20_{exchange}_{symbol}")
        ],
        [
            InlineKeyboardButton("50x", callback_data=f"leverage_50_{exchange}_{symbol}"),
            InlineKeyboardButton("100x", callback_data=f"leverage_100_{exchange}_{symbol}"),
            InlineKeyboardButton("Custom", callback_data=f"leverage_custom_{exchange}_{symbol}")
        ],
        [
            InlineKeyboardButton("üîô Back", callback_data=f"trade_symbol_{exchange}")
        ]
    ]
    return InlineKeyboardMarkup(keyboard)


def get_order_type_keyboard(exchange: str, market_type: str, side: str) -> InlineKeyboardMarkup:
    """Get order type selection keyboard"""
    keyboard = [
        [
            InlineKeyboardButton("üìà Market Order", callback_data=f"order_type_market_{exchange}_{market_type}_{side}"),
            InlineKeyboardButton("üìä Limit Order", callback_data=f"order_type_limit_{exchange}_{market_type}_{side}")
        ],
        [
            InlineKeyboardButton("üîô Back to Side", callback_data=f"trade_market_{market_type}_{exchange}")
        ]
    ]
    return InlineKeyboardMarkup(keyboard)


def get_quick_trade_keyboard() -> InlineKeyboardMarkup:
    """Get quick trade keyboard"""
    keyboard = [
        [
            InlineKeyboardButton("üõí Quick Buy", callback_data="quick_buy"),
            InlineKeyboardButton("üõçÔ∏è Quick Sell", callback_data="quick_sell")
        ],
        [
            InlineKeyboardButton("üìä Close Position", callback_data="quick_close"),
            InlineKeyboardButton("‚öôÔ∏è Set Leverage", callback_data="quick_leverage")
        ],
        [
            InlineKeyboardButton("üîô Back to Main", callback_data="menu_main")
        ]
    ]
    return InlineKeyboardMarkup(keyboard)
